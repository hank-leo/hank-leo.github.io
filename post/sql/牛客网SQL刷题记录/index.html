<!doctype html>
<html lang="zh-CN">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>牛客网SQL刷题记录 | Hank&#39;s Blog</title>
    <meta property="og:title" content="牛客网SQL刷题记录 - Hank&#39;s Blog">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2020-08-26T00:00:00&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2020-08-26T00:00:00&#43;08:00'>
        
    <meta name="Keywords" content="Hank,博客,python">
    <meta name="description" content="牛客网SQL刷题记录">
        
    <meta name="author" content="Hank">
    <meta property="og:url" content="https://hank-leo.github.io/post/sql/%E7%89%9B%E5%AE%A2%E7%BD%91SQL%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
    
    
    
        <link rel="stylesheet" href='/css/douban.css'>
    
        <link rel="stylesheet" href='/css/other.css'>
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://hank-leo.github.io">
                        Hank&#39;s Blog
                    </a>
                
                <p class="description">专注于Python、SQL、爬虫、数据分析/挖掘/可视化</p>
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="current" href="https://hank-leo.github.io">首页</a>
                    
                    <a  href="https://hank-leo.github.io/archives/" title="归档">归档</a>
                    
                    <a  href="https://hank-leo.github.io/tags/" title="标签">标签</a>
                    
                    <a  href="https://hank-leo.github.io/categories/" title="分类">分类</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    <style type="text/css">
    .post-toc {
        position: fixed;
        width: 200px;
        margin-left: -210px;
        padding: 5px 10px;
        font-family: Athelas, STHeiti, Microsoft Yahei, serif;
        font-size: 12px;
        border: 1px solid rgba(0, 0, 0, .07);
        border-radius: 5px;
        background-color: rgba(255, 255, 255, 0.98);
        background-clip: padding-box;
        -webkit-box-shadow: 1px 1px 2px rgba(0, 0, 0, .125);
        box-shadow: 1px 1px 2px rgba(0, 0, 0, .125);
        word-wrap: break-word;
        white-space: nowrap;
        -webkit-box-sizing: border-box;
        box-sizing: border-box;
        z-index: 999;
        cursor: pointer;
        max-height: 70%;
        overflow-y: auto;
        overflow-x: hidden;
    }

    .post-toc .post-toc-title {
        width: 100%;
        margin: 0 auto;
        font-size: 20px;
        font-weight: 400;
        text-transform: uppercase;
        text-align: center;
    }

    .post-toc .post-toc-content {
        font-size: 15px;
    }

    .post-toc .post-toc-content>nav>ul {
        margin: 10px 0;
    }

    .post-toc .post-toc-content ul {
        padding-left: 20px;
        list-style: square;
        margin: 0.5em;
        line-height: 1.8em;
    }

    .post-toc .post-toc-content ul ul {
        padding-left: 15px;
        display: none;
    }

    @media print,
    screen and (max-width:1057px) {
        .post-toc {
            display: none;
        }
    }
</style>
<div class="post-toc" style="position: absolute; top: 188px;">
    <h4 class="post-toc-title">目录</h4>
    <div class="post-toc-content">
        <nav id="TableOfContents"></nav>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function () {
        var postToc = $(".post-toc");
        if (postToc.length) {
            var leftPos = $("#main").offset().left;
            if(leftPos<220){
                postToc.css({"width":leftPos-10,"margin-left":(0-leftPos)})
            }

            var t = postToc.offset().top - 20,
                a = {
                    start: {
                        position: "absolute",
                        top: t
                    },
                    process: {
                        position: "fixed",
                        top: 20
                    },
                };
            $(window).scroll(function () {
                var e = $(window).scrollTop();
                e < t ? postToc.css(a.start) : postToc.css(a.process)
            })
        }
    })
</script>
    <article class="post">
        <header>
            <h1 class="post-title">牛客网SQL刷题记录</h1>
        </header>
        <date class="post-meta meta-date">
            2020年8月26日
        </date>
        
        <div class="post-meta">
            <span>|</span>
            
            <span class="meta-category"><a href='https://hank-leo.github.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%A6%E4%B9%A0'>数据库学习</a></span>
            
        </div>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span>
                    阅读</span></span>
        </div>
        
        
        <div class="post-content">
            <p><a href="https://www.nowcoder.com/practice/218ae58dfdcd4af195fff264e062138f?tpId=82&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking">1.查找最晚入职员工的所有信息</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> <span style="color:#000;font-weight:bold">*</span> <span style="color:#000;font-weight:bold">from</span> employees
<span style="color:#000;font-weight:bold">order</span> <span style="color:#000;font-weight:bold">by</span> hire_date <span style="color:#000;font-weight:bold">desc</span> <span style="color:#000;font-weight:bold">limit</span> <span style="color:#099">0</span>,<span style="color:#099">1</span>;
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/ec1ca44c62c14ceb990c3c40def1ec6c?tpId=82&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking">2.查找入职员工时间排名倒数第三的员工所有信息</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> <span style="color:#000;font-weight:bold">*</span> <span style="color:#000;font-weight:bold">from</span> employees
<span style="color:#000;font-weight:bold">order</span> <span style="color:#000;font-weight:bold">by</span> hire_date <span style="color:#000;font-weight:bold">desc</span> <span style="color:#000;font-weight:bold">limit</span> <span style="color:#099">2</span>,<span style="color:#099">1</span>;
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/c63c5b54d86e4c6d880e4834bfd70c3b?tpId=82&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking">3.查找当前薪水详情以及部门编号dept_no</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> salaries.<span style="color:#000;font-weight:bold">*</span>,dept_manager.dept_no <span style="color:#000;font-weight:bold">from</span> salaries,dept_manager
<span style="color:#000;font-weight:bold">on</span> salaries.emp_no <span style="color:#000;font-weight:bold">=</span> dept_manager.emp_no
<span style="color:#000;font-weight:bold">where</span> salaries.to_date<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;</span><span style="color:#d14">9999-01-01</span><span style="color:#d14">&#39;</span> <span style="color:#000;font-weight:bold">and</span> dept_manager.to_date<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;</span><span style="color:#d14">9999-01-01</span><span style="color:#d14">&#39;</span>;
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/6d35b1cd593545ab985a68cd86f28671?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">4.查找所有已经分配部门的员工的last_name和first_name以及dept_no</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> employees.last_name,employees.first_name,dept_emp.dept_no
<span style="color:#000;font-weight:bold">from</span> employees,dept_emp
<span style="color:#000;font-weight:bold">on</span> employees.emp_no <span style="color:#000;font-weight:bold">=</span> dept_emp.emp_no;
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/dbfafafb2ee2482aa390645abd4463bf?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">5.查找所有员工的last_name和first_name以及对应部门编号dept_no，也包括暂时没有分配具体部门的员工</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> employees.last_name,employees.first_name,dept_emp.dept_no
<span style="color:#000;font-weight:bold">from</span> employees
<span style="color:#000;font-weight:bold">left</span> <span style="color:#000;font-weight:bold">join</span> dept_emp
<span style="color:#000;font-weight:bold">on</span> dept_emp.emp_no<span style="color:#000;font-weight:bold">=</span>employees.emp_no;
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/23142e7a23e4480781a3b978b5e0f33a?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">6.查找所有员工入职时候的薪水情况，给出emp_no以及salary， 并按照emp_no进行逆序</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> employees.emp_no,salaries.salary <span style="color:#000;font-weight:bold">from</span> employees
<span style="color:#000;font-weight:bold">left</span> <span style="color:#000;font-weight:bold">join</span> salaries
<span style="color:#000;font-weight:bold">where</span> employees.emp_no<span style="color:#000;font-weight:bold">=</span>salaries.emp_no
<span style="color:#000;font-weight:bold">and</span> employees.hire_date <span style="color:#000;font-weight:bold">=</span> salaries.from_date
<span style="color:#000;font-weight:bold">order</span> <span style="color:#000;font-weight:bold">by</span> employees.emp_no <span style="color:#000;font-weight:bold">desc</span>;
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/6d4a4cff1d58495182f536c548fee1ae?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">7.查找薪水变动超过15次的员工号emp_no以及其对应的变动次数t</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> emp_no,<span style="color:#000;font-weight:bold">count</span>(emp_no) <span style="color:#000;font-weight:bold">as</span> t
<span style="color:#000;font-weight:bold">from</span> salaries
<span style="color:#000;font-weight:bold">group</span> <span style="color:#000;font-weight:bold">by</span> emp_no
<span style="color:#000;font-weight:bold">having</span> <span style="color:#000;font-weight:bold">count</span>(emp_no)<span style="color:#000;font-weight:bold">&gt;</span><span style="color:#099">15</span>;
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/ae51e6d057c94f6d891735a48d1c2397?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">8.找出所有员工当前(to_date='9999-01-01&rsquo;)具体的薪水salary情况，对于相同的薪水只显示一次,并按照逆序显示</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> <span style="color:#000;font-weight:bold">distinct</span> salary <span style="color:#000;font-weight:bold">from</span> salaries
<span style="color:#000;font-weight:bold">where</span> to_date<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;</span><span style="color:#d14">9999-01-01</span><span style="color:#d14">&#39;</span>
<span style="color:#000;font-weight:bold">order</span> <span style="color:#000;font-weight:bold">by</span> salary <span style="color:#000;font-weight:bold">desc</span>;
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/4c8b4a10ca5b44189e411107e1d8bec1?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">9.获取所有部门当前(dept_manager.to_date='9999-01-01&rsquo;)manager的当前(salaries.to_date='9999-01-01&rsquo;)薪水情况，给出dept_no, emp_no以及salary</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> d.dept_no,s.emp_no,s.salary
<span style="color:#000;font-weight:bold">from</span> dept_manager d,salaries s
<span style="color:#000;font-weight:bold">where</span> d.to_date<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;</span><span style="color:#d14">9999-01-01</span><span style="color:#d14">&#39;</span>
<span style="color:#000;font-weight:bold">and</span> s.to_date<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;</span><span style="color:#d14">9999-01-01</span><span style="color:#d14">&#39;</span>
<span style="color:#000;font-weight:bold">and</span> d.emp_no<span style="color:#000;font-weight:bold">=</span>s.emp_no;
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/32c53d06443346f4a2f2ca733c19660c?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">10.获取所有非manager的员工emp_no</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> emp_no
<span style="color:#000;font-weight:bold">from</span> employees
<span style="color:#000;font-weight:bold">where</span> emp_no
<span style="color:#000;font-weight:bold">not</span> <span style="color:#000;font-weight:bold">in</span> (<span style="color:#000;font-weight:bold">select</span> emp_no <span style="color:#000;font-weight:bold">from</span> dept_manager);
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/e50d92b8673a440ebdf3a517b5b37d62?tpId=82&amp;&amp;tqId=29763&amp;rp=1&amp;ru=/ta/sql&amp;qru=/ta/sql/question-ranking">11.获取所有员工当前的(dept_manager.to_date='9999-01-01&rsquo;)manager，如果员工是manager的话不显示(也就是如果当前的manager是自己的话结果不显示)。输出结果第一列给出当前员工的emp_no,第二列给出其manager对应的emp_no</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> de.emp_no,dm.emp_no <span style="color:#000;font-weight:bold">as</span> manager_no
<span style="color:#000;font-weight:bold">from</span> dept_emp <span style="color:#000;font-weight:bold">as</span> de
<span style="color:#000;font-weight:bold">inner</span> <span style="color:#000;font-weight:bold">join</span> dept_manager <span style="color:#000;font-weight:bold">as</span> dm
<span style="color:#000;font-weight:bold">on</span> de.dept_no<span style="color:#000;font-weight:bold">=</span>dm.dept_no
<span style="color:#000;font-weight:bold">where</span> dm.to_date<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;</span><span style="color:#d14">9999-01-01</span><span style="color:#d14">&#39;</span>
<span style="color:#000;font-weight:bold">and</span> de.to_date<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;</span><span style="color:#d14">9999-01-01</span><span style="color:#d14">&#39;</span>
<span style="color:#000;font-weight:bold">and</span> de.emp_no <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#000;font-weight:bold">&gt;</span> dm.emp_no;
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/4a052e3e1df5435880d4353eb18a91c6?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">12.获取所有部门中当前(dept_emp.to_date = &lsquo;9999-01-01&rsquo;)员工当前(salaries.to_date='9999-01-01&rsquo;)薪水最高的相关信息，给出dept_no, emp_no以及其对应的salary，按照部门升序排列</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> e.dept_no,e.emp_no,<span style="color:#000;font-weight:bold">MAX</span>(s.salary)
<span style="color:#000;font-weight:bold">from</span> dept_emp e <span style="color:#000;font-weight:bold">inner</span> <span style="color:#000;font-weight:bold">join</span> salaries s
<span style="color:#000;font-weight:bold">on</span> e.emp_no <span style="color:#000;font-weight:bold">=</span> s.emp_no 
<span style="color:#000;font-weight:bold">where</span> s.to_date<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;</span><span style="color:#d14">9999-01-01</span><span style="color:#d14">&#39;</span> <span style="color:#000;font-weight:bold">and</span> e.to_date <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;</span><span style="color:#d14">9999-01-01</span><span style="color:#d14">&#39;</span>
<span style="color:#000;font-weight:bold">GROUP</span> <span style="color:#000;font-weight:bold">BY</span> e.dept_no
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/72ca694734294dc78f513e147da7821e?tpId=82&amp;&amp;tqId=29765&amp;rp=1&amp;ru=/ta/sql&amp;qru=/ta/sql/question-ranking">13.从titles表获取按照title进行分组，每组个数大于等于2，给出title以及对应的数目t</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> title,<span style="color:#000;font-weight:bold">count</span>(title) t
<span style="color:#000;font-weight:bold">from</span> titles
<span style="color:#000;font-weight:bold">group</span> <span style="color:#000;font-weight:bold">by</span> title
<span style="color:#000;font-weight:bold">having</span> t <span style="color:#000;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">=</span> <span style="color:#099">2</span>
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/c59b452f420c47f48d9c86d69efdff20?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">14.从titles表获取按照title进行分组，每组个数大于等于2，给出title以及对应的数目t。
注意对于重复的emp_no进行忽略(即emp_no重复的title不计算，title对应的数目t不增加)。</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> title,<span style="color:#000;font-weight:bold">count</span>(<span style="color:#000;font-weight:bold">distinct</span> emp_no) t
<span style="color:#000;font-weight:bold">from</span> titles
<span style="color:#000;font-weight:bold">group</span> <span style="color:#000;font-weight:bold">by</span> title
<span style="color:#000;font-weight:bold">having</span> t<span style="color:#000;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">=</span> <span style="color:#099">2</span>
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/a32669eb1d1740e785f105fa22741d5c?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">15.查找employees表所有emp_no为奇数，且last_name不为Mary(注意大小写)的员工信息，并按照hire_date逆序排列(题目不能使用mod函数)</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> <span style="color:#000;font-weight:bold">*</span> <span style="color:#000;font-weight:bold">from</span> employees
<span style="color:#000;font-weight:bold">where</span> emp_no<span style="color:#000;font-weight:bold">%</span><span style="color:#099">2</span><span style="color:#000;font-weight:bold">=</span><span style="color:#099">1</span>
<span style="color:#000;font-weight:bold">and</span> last_name<span style="color:#000;font-weight:bold">&lt;</span><span style="color:#000;font-weight:bold">&gt;</span><span style="color:#d14">&#34;</span><span style="color:#d14">Mary</span><span style="color:#d14">&#34;</span>
<span style="color:#000;font-weight:bold">order</span> <span style="color:#000;font-weight:bold">by</span> hire_date <span style="color:#000;font-weight:bold">desc</span>
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/c8652e9e5a354b879e2a244200f1eaae?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">16.统计出当前(titles.to_date='9999-01-01&rsquo;)各个title类型对应的员工当前(salaries.to_date='9999-01-01&rsquo;)薪水对应的平均工资。结果给出title以及平均工资avg。</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> t.title,<span style="color:#000;font-weight:bold">avg</span>(s.salary)
<span style="color:#000;font-weight:bold">from</span> titles t
<span style="color:#000;font-weight:bold">join</span> salaries s
<span style="color:#000;font-weight:bold">on</span> t.emp_no<span style="color:#000;font-weight:bold">=</span>s.emp_no
<span style="color:#000;font-weight:bold">where</span> t.to_date<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;</span><span style="color:#d14">9999-01-01</span><span style="color:#d14">&#39;</span>
<span style="color:#000;font-weight:bold">and</span> s.to_date<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;</span><span style="color:#d14">9999-01-01</span><span style="color:#d14">&#39;</span>
<span style="color:#000;font-weight:bold">group</span> <span style="color:#000;font-weight:bold">by</span> t.title
</code></pre></td></tr></table>
</div>
</div><p><a href="nowcoder.com/practice/8d2c290cc4e24403b98ca82ce45d04db?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">17.获取当前（to_date='9999-01-01&rsquo;）薪水第二多的员工的emp_no以及其对应的薪水salary</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> emp_no,salary
<span style="color:#000;font-weight:bold">from</span> salaries
<span style="color:#000;font-weight:bold">order</span> <span style="color:#000;font-weight:bold">by</span> salary <span style="color:#000;font-weight:bold">desc</span> <span style="color:#000;font-weight:bold">limit</span> <span style="color:#099">1</span>,<span style="color:#099">1</span>
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/c1472daba75d4635b7f8540b837cc719?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">18.查找当前薪水(to_date='9999-01-01&rsquo;)排名第二多的员工编号emp_no、薪水salary、last_name以及first_name，你可以不使用order by完成吗</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> e.emp_no,<span style="color:#000;font-weight:bold">max</span>(s.salary) <span style="color:#000;font-weight:bold">as</span> salary,e.last_name,e.first_name
<span style="color:#000;font-weight:bold">from</span> employees e
<span style="color:#000;font-weight:bold">join</span> salaries s
<span style="color:#000;font-weight:bold">on</span> e.emp_no<span style="color:#000;font-weight:bold">=</span>s.emp_no
<span style="color:#000;font-weight:bold">where</span> s.salary <span style="color:#000;font-weight:bold">not</span> <span style="color:#000;font-weight:bold">in</span> (
<span style="color:#000;font-weight:bold">select</span> <span style="color:#000;font-weight:bold">max</span>(salary)
    <span style="color:#000;font-weight:bold">from</span> salaries
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/5a7975fabe1146329cee4f670c27ad55?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">19.查找所有员工的last_name和first_name以及对应的dept_name，也包括暂时没有分配部门的员工</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> e.last_name,e.first_name,d.dept_name
<span style="color:#000;font-weight:bold">from</span> employees e
<span style="color:#000;font-weight:bold">left</span> <span style="color:#000;font-weight:bold">join</span> dept_emp de
<span style="color:#000;font-weight:bold">on</span> e.emp_no<span style="color:#000;font-weight:bold">=</span>de.emp_no
<span style="color:#000;font-weight:bold">left</span> <span style="color:#000;font-weight:bold">join</span> departments d
<span style="color:#000;font-weight:bold">on</span> de.dept_no<span style="color:#000;font-weight:bold">=</span>d.dept_no
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/c727647886004942a89848e2b5130dc2?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">20.查找员工编号emp_no为10001其自入职以来的薪水salary涨幅(总共涨了多少)growth(可能有多次涨薪，没有降薪)</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> <span style="color:#000;font-weight:bold">max</span>(salary)<span style="color:#000;font-weight:bold">-</span><span style="color:#000;font-weight:bold">min</span>(salary) growth
<span style="color:#000;font-weight:bold">from</span> salaries
<span style="color:#000;font-weight:bold">where</span> emp_no<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;</span><span style="color:#d14">10001</span><span style="color:#d14">&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/fc7344ece7294b9e98401826b94c6ea5?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">21.查找所有员工自入职以来的薪水涨幅情况，给出员工编号emp_no以及其对应的薪水涨幅growth，并按照growth进行升序</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> a.emp_no,(b.salary<span style="color:#000;font-weight:bold">-</span><span style="color:#000;font-weight:bold">c</span>.salary) growth
<span style="color:#000;font-weight:bold">from</span> employees <span style="color:#000;font-weight:bold">as</span> a
<span style="color:#000;font-weight:bold">inner</span> <span style="color:#000;font-weight:bold">join</span> salaries <span style="color:#000;font-weight:bold">as</span> b
<span style="color:#000;font-weight:bold">on</span> a.emp_no<span style="color:#000;font-weight:bold">=</span>b.emp_no
<span style="color:#000;font-weight:bold">and</span> b.to_date<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;</span><span style="color:#d14">9999-01-01</span><span style="color:#d14">&#34;</span>
<span style="color:#000;font-weight:bold">inner</span> <span style="color:#000;font-weight:bold">join</span> salaries <span style="color:#000;font-weight:bold">as</span> <span style="color:#000;font-weight:bold">c</span>
<span style="color:#000;font-weight:bold">on</span> a.emp_no<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">c</span>.emp_no
<span style="color:#000;font-weight:bold">and</span> a.hire_date<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">c</span>.from_date
<span style="color:#000;font-weight:bold">order</span> <span style="color:#000;font-weight:bold">by</span> growth <span style="color:#000;font-weight:bold">asc</span>
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/6a62b6c0a7324350a6d9959fa7c21db3?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">22.统计各个部门的工资记录数，给出部门编码dept_no、部门名称dept_name以及部门在salaries表里面有多少条记录sum</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> d.dept_no,d.dept_name,<span style="color:#000;font-weight:bold">count</span>(<span style="color:#000;font-weight:bold">*</span>)<span style="color:#000;font-weight:bold">sum</span>
<span style="color:#000;font-weight:bold">from</span> departments d
<span style="color:#000;font-weight:bold">inner</span> <span style="color:#000;font-weight:bold">join</span> dept_emp de
<span style="color:#000;font-weight:bold">on</span> d.dept_no<span style="color:#000;font-weight:bold">=</span>de.dept_no
<span style="color:#000;font-weight:bold">inner</span> <span style="color:#000;font-weight:bold">join</span> salaries s
<span style="color:#000;font-weight:bold">on</span> s.emp_no<span style="color:#000;font-weight:bold">=</span>de.emp_no
<span style="color:#000;font-weight:bold">group</span> <span style="color:#000;font-weight:bold">by</span> de.dept_no
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/b9068bfe5df74276bd015b9729eec4bf?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">23.对所有员工的当前(to_date='9999-01-01&rsquo;)薪水按照salary进行按照1-N的排名，相同salary并列且按照emp_no升序排列</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> emp_no,salary,dense_rank() over (<span style="color:#000;font-weight:bold">order</span> <span style="color:#000;font-weight:bold">by</span> salary <span style="color:#000;font-weight:bold">desc</span>) <span style="color:#000;font-weight:bold">as</span> rank
<span style="color:#000;font-weight:bold">from</span> salaries
<span style="color:#000;font-weight:bold">where</span> to_date<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;</span><span style="color:#d14">9999-01-01</span><span style="color:#d14">&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/8fe212a6c71b42de9c15c56ce354bebe?tpId=82&amp;&amp;tqId=29776&amp;rp=1&amp;ru=/ta/sql&amp;qru=/ta/sql/question-ranking">24.获取所有非manager员工当前的薪水情况，给出dept_no、emp_no以及salary ，当前表示to_date='9999-01-01&rsquo;</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> de.dept_no,e.emp_no,s.salary
<span style="color:#000;font-weight:bold">from</span> dept_emp de
<span style="color:#000;font-weight:bold">inner</span> <span style="color:#000;font-weight:bold">join</span> employees e
<span style="color:#000;font-weight:bold">on</span> e.emp_no<span style="color:#000;font-weight:bold">=</span>de.emp_no
<span style="color:#000;font-weight:bold">inner</span> <span style="color:#000;font-weight:bold">join</span> salaries s
<span style="color:#000;font-weight:bold">on</span> de.emp_no<span style="color:#000;font-weight:bold">=</span>s.emp_no
<span style="color:#000;font-weight:bold">where</span> s.to_date<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;</span><span style="color:#d14">9999-01-01</span><span style="color:#d14">&#34;</span>
<span style="color:#000;font-weight:bold">and</span> de.emp_no <span style="color:#000;font-weight:bold">not</span> <span style="color:#000;font-weight:bold">in</span> (
<span style="color:#000;font-weight:bold">select</span> emp_no <span style="color:#000;font-weight:bold">from</span> dept_manager
)
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/f858d74a030e48da8e0f69e21be63bef?tpId=82&amp;&amp;tqId=29777&amp;rp=1&amp;ru=/ta/sql&amp;qru=/ta/sql/question-ranking">25.获取员工其当前的薪水比其manager当前薪水还高的相关信息</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#a61717;background-color:#e3d2d2">获</span><span style="color:#a61717;background-color:#e3d2d2">取</span><span style="color:#a61717;background-color:#e3d2d2">员</span><span style="color:#a61717;background-color:#e3d2d2">工</span><span style="color:#a61717;background-color:#e3d2d2">其</span><span style="color:#a61717;background-color:#e3d2d2">当</span><span style="color:#a61717;background-color:#e3d2d2">前</span><span style="color:#a61717;background-color:#e3d2d2">的</span><span style="color:#a61717;background-color:#e3d2d2">薪</span><span style="color:#a61717;background-color:#e3d2d2">水</span><span style="color:#a61717;background-color:#e3d2d2">比</span><span style="color:#a61717;background-color:#e3d2d2">其</span>manager当前薪水还高的相关信息<span style="color:#a61717;background-color:#e3d2d2">，</span><span style="color:#a61717;background-color:#e3d2d2">当</span><span style="color:#a61717;background-color:#e3d2d2">前</span><span style="color:#a61717;background-color:#e3d2d2">表</span><span style="color:#a61717;background-color:#e3d2d2">示</span>to_date<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;</span><span style="color:#d14">9999-01-01</span><span style="color:#d14">&#39;</span>,
<span style="color:#a61717;background-color:#e3d2d2">结</span><span style="color:#a61717;background-color:#e3d2d2">果</span><span style="color:#a61717;background-color:#e3d2d2">第</span><span style="color:#a61717;background-color:#e3d2d2">一</span><span style="color:#a61717;background-color:#e3d2d2">列</span><span style="color:#a61717;background-color:#e3d2d2">给</span><span style="color:#a61717;background-color:#e3d2d2">出</span><span style="color:#a61717;background-color:#e3d2d2">员</span><span style="color:#a61717;background-color:#e3d2d2">工</span><span style="color:#a61717;background-color:#e3d2d2">的</span>emp_no<span style="color:#a61717;background-color:#e3d2d2">，</span>
<span style="color:#a61717;background-color:#e3d2d2">第</span><span style="color:#a61717;background-color:#e3d2d2">二</span><span style="color:#a61717;background-color:#e3d2d2">列</span><span style="color:#a61717;background-color:#e3d2d2">给</span><span style="color:#a61717;background-color:#e3d2d2">出</span><span style="color:#a61717;background-color:#e3d2d2">其</span>manager的manager_no<span style="color:#a61717;background-color:#e3d2d2">，</span>
<span style="color:#a61717;background-color:#e3d2d2">第</span><span style="color:#a61717;background-color:#e3d2d2">三</span><span style="color:#a61717;background-color:#e3d2d2">列</span><span style="color:#a61717;background-color:#e3d2d2">给</span><span style="color:#a61717;background-color:#e3d2d2">出</span><span style="color:#a61717;background-color:#e3d2d2">该</span><span style="color:#a61717;background-color:#e3d2d2">员</span><span style="color:#a61717;background-color:#e3d2d2">工</span><span style="color:#a61717;background-color:#e3d2d2">当</span><span style="color:#a61717;background-color:#e3d2d2">前</span><span style="color:#a61717;background-color:#e3d2d2">的</span><span style="color:#a61717;background-color:#e3d2d2">薪</span><span style="color:#a61717;background-color:#e3d2d2">水</span>emp_salary,
<span style="color:#a61717;background-color:#e3d2d2">第</span><span style="color:#a61717;background-color:#e3d2d2">四</span><span style="color:#a61717;background-color:#e3d2d2">列</span><span style="color:#a61717;background-color:#e3d2d2">给</span><span style="color:#a61717;background-color:#e3d2d2">该</span><span style="color:#a61717;background-color:#e3d2d2">员</span><span style="color:#a61717;background-color:#e3d2d2">工</span><span style="color:#a61717;background-color:#e3d2d2">对</span><span style="color:#a61717;background-color:#e3d2d2">应</span><span style="color:#a61717;background-color:#e3d2d2">的</span>manager当前的薪水manager_salary
<span style="color:#000;font-weight:bold">CREATE</span> <span style="color:#000;font-weight:bold">TABLE</span> <span style="color:#000;font-weight:bold">`</span>dept_emp<span style="color:#000;font-weight:bold">`</span> (
<span style="color:#000;font-weight:bold">`</span>emp_no<span style="color:#000;font-weight:bold">`</span> <span style="color:#0086b3">int</span>(<span style="color:#099">11</span>) <span style="color:#000;font-weight:bold">NOT</span> <span style="color:#000;font-weight:bold">NULL</span>,
<span style="color:#000;font-weight:bold">`</span>dept_no<span style="color:#000;font-weight:bold">`</span> <span style="color:#0086b3">char</span>(<span style="color:#099">4</span>) <span style="color:#000;font-weight:bold">NOT</span> <span style="color:#000;font-weight:bold">NULL</span>,
<span style="color:#000;font-weight:bold">`</span>from_date<span style="color:#000;font-weight:bold">`</span> <span style="color:#0086b3">date</span> <span style="color:#000;font-weight:bold">NOT</span> <span style="color:#000;font-weight:bold">NULL</span>,
<span style="color:#000;font-weight:bold">`</span>to_date<span style="color:#000;font-weight:bold">`</span> <span style="color:#0086b3">date</span> <span style="color:#000;font-weight:bold">NOT</span> <span style="color:#000;font-weight:bold">NULL</span>,
<span style="color:#000;font-weight:bold">PRIMARY</span> <span style="color:#000;font-weight:bold">KEY</span> (<span style="color:#000;font-weight:bold">`</span>emp_no<span style="color:#000;font-weight:bold">`</span>,<span style="color:#000;font-weight:bold">`</span>dept_no<span style="color:#000;font-weight:bold">`</span>));
<span style="color:#000;font-weight:bold">CREATE</span> <span style="color:#000;font-weight:bold">TABLE</span> <span style="color:#000;font-weight:bold">`</span>dept_manager<span style="color:#000;font-weight:bold">`</span> (
<span style="color:#000;font-weight:bold">`</span>dept_no<span style="color:#000;font-weight:bold">`</span> <span style="color:#0086b3">char</span>(<span style="color:#099">4</span>) <span style="color:#000;font-weight:bold">NOT</span> <span style="color:#000;font-weight:bold">NULL</span>,
<span style="color:#000;font-weight:bold">`</span>emp_no<span style="color:#000;font-weight:bold">`</span> <span style="color:#0086b3">int</span>(<span style="color:#099">11</span>) <span style="color:#000;font-weight:bold">NOT</span> <span style="color:#000;font-weight:bold">NULL</span>,
<span style="color:#000;font-weight:bold">`</span>from_date<span style="color:#000;font-weight:bold">`</span> <span style="color:#0086b3">date</span> <span style="color:#000;font-weight:bold">NOT</span> <span style="color:#000;font-weight:bold">NULL</span>,
<span style="color:#000;font-weight:bold">`</span>to_date<span style="color:#000;font-weight:bold">`</span> <span style="color:#0086b3">date</span> <span style="color:#000;font-weight:bold">NOT</span> <span style="color:#000;font-weight:bold">NULL</span>,
<span style="color:#000;font-weight:bold">PRIMARY</span> <span style="color:#000;font-weight:bold">KEY</span> (<span style="color:#000;font-weight:bold">`</span>emp_no<span style="color:#000;font-weight:bold">`</span>,<span style="color:#000;font-weight:bold">`</span>dept_no<span style="color:#000;font-weight:bold">`</span>));
<span style="color:#000;font-weight:bold">CREATE</span> <span style="color:#000;font-weight:bold">TABLE</span> <span style="color:#000;font-weight:bold">`</span>salaries<span style="color:#000;font-weight:bold">`</span> (
<span style="color:#000;font-weight:bold">`</span>emp_no<span style="color:#000;font-weight:bold">`</span> <span style="color:#0086b3">int</span>(<span style="color:#099">11</span>) <span style="color:#000;font-weight:bold">NOT</span> <span style="color:#000;font-weight:bold">NULL</span>,
<span style="color:#000;font-weight:bold">`</span>salary<span style="color:#000;font-weight:bold">`</span> <span style="color:#0086b3">int</span>(<span style="color:#099">11</span>) <span style="color:#000;font-weight:bold">NOT</span> <span style="color:#000;font-weight:bold">NULL</span>,
<span style="color:#000;font-weight:bold">`</span>from_date<span style="color:#000;font-weight:bold">`</span> <span style="color:#0086b3">date</span> <span style="color:#000;font-weight:bold">NOT</span> <span style="color:#000;font-weight:bold">NULL</span>,
<span style="color:#000;font-weight:bold">`</span>to_date<span style="color:#000;font-weight:bold">`</span> <span style="color:#0086b3">date</span> <span style="color:#000;font-weight:bold">NOT</span> <span style="color:#000;font-weight:bold">NULL</span>,
<span style="color:#000;font-weight:bold">PRIMARY</span> <span style="color:#000;font-weight:bold">KEY</span> (<span style="color:#000;font-weight:bold">`</span>emp_no<span style="color:#000;font-weight:bold">`</span>,<span style="color:#000;font-weight:bold">`</span>from_date<span style="color:#000;font-weight:bold">`</span>));
</code></pre></td></tr></table>
</div>
</div><p>答案：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">SELECT</span> sem.emp_no <span style="color:#000;font-weight:bold">AS</span> emp_no, sdm.emp_no <span style="color:#000;font-weight:bold">AS</span> manager_no, sem.salary <span style="color:#000;font-weight:bold">AS</span> emp_salary, sdm.salary <span style="color:#000;font-weight:bold">AS</span> manager_salary
<span style="color:#000;font-weight:bold">FROM</span> (
    <span style="color:#000;font-weight:bold">SELECT</span> s.salary, s.emp_no, de.dept_no
    <span style="color:#000;font-weight:bold">FROM</span> salaries s
    <span style="color:#000;font-weight:bold">INNER</span> <span style="color:#000;font-weight:bold">JOIN</span> dept_emp de 
    <span style="color:#000;font-weight:bold">ON</span> s.emp_no <span style="color:#000;font-weight:bold">=</span> de.emp_no
    <span style="color:#000;font-weight:bold">AND</span> s.to_date <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;</span><span style="color:#d14">9999-01-01</span><span style="color:#d14">&#39;</span>) <span style="color:#000;font-weight:bold">AS</span> sem, 
    (<span style="color:#000;font-weight:bold">SELECT</span> s.salary, s.emp_no, dm.dept_no
    <span style="color:#000;font-weight:bold">FROM</span> salaries s
    <span style="color:#000;font-weight:bold">INNER</span> <span style="color:#000;font-weight:bold">JOIN</span> dept_manager dm 
    <span style="color:#000;font-weight:bold">ON</span> s.emp_no <span style="color:#000;font-weight:bold">=</span> dm.emp_no
    <span style="color:#000;font-weight:bold">AND</span> s.to_date <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;</span><span style="color:#d14">9999-01-01</span><span style="color:#d14">&#39;</span>) <span style="color:#000;font-weight:bold">AS</span> sdm
<span style="color:#000;font-weight:bold">WHERE</span> sem.dept_no <span style="color:#000;font-weight:bold">=</span> sdm.dept_no
<span style="color:#000;font-weight:bold">AND</span> sem.salary <span style="color:#000;font-weight:bold">&gt;</span> sdm.salary
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/4bcb6a7d3e39423291d2f7bdbbff87f8?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">26.汇总各个部门当前员工的title类型的分配数目，即结果给出部门编号dept_no、dept_name、其部门下所有的当前(dept_emp.to_date = &lsquo;9999-01-01&rsquo;)员工的当前(titles.to_date = &lsquo;9999-01-01&rsquo;)title以及该类型title对应的数目count</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> de.dept_no,dp.dept_name,t.title,<span style="color:#000;font-weight:bold">count</span>(t.title) <span style="color:#000;font-weight:bold">as</span> title
<span style="color:#000;font-weight:bold">from</span> titles <span style="color:#000;font-weight:bold">as</span> t
<span style="color:#000;font-weight:bold">inner</span> <span style="color:#000;font-weight:bold">join</span> dept_emp <span style="color:#000;font-weight:bold">as</span> de
<span style="color:#000;font-weight:bold">on</span> t.emp_no<span style="color:#000;font-weight:bold">=</span>de.emp_no
<span style="color:#000;font-weight:bold">and</span> de.to_date<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;</span><span style="color:#d14">9999-01-01</span><span style="color:#d14">&#39;</span>
<span style="color:#000;font-weight:bold">and</span> t.to_date<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;</span><span style="color:#d14">9999-01-01</span><span style="color:#d14">&#39;</span>
<span style="color:#000;font-weight:bold">inner</span> <span style="color:#000;font-weight:bold">join</span> departments <span style="color:#000;font-weight:bold">as</span> dp
<span style="color:#000;font-weight:bold">on</span> de.dept_no<span style="color:#000;font-weight:bold">=</span>dp.dept_no
<span style="color:#000;font-weight:bold">group</span> <span style="color:#000;font-weight:bold">by</span> de.dept_no,t.title
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/eb9b13e5257744db8265aa73de04fd44?tpId=82&amp;&amp;tqId=29779&amp;rp=1&amp;ru=/ta/sql&amp;qru=/ta/sql/question-ranking">27.给出每个员工每年薪水涨幅超过5000的员工编号emp_no、薪水变更开始日期from_date以及薪水涨幅值salary_growth，并按照salary_growth逆序排列</a></p>
<p><a href="https://www.nowcoder.com/practice/3a303a39cc40489b99a7e1867e6507c5?tpId=82&amp;&amp;tqId=29780&amp;rp=1&amp;ru=/ta/sql&amp;qru=/ta/sql/question-ranking">28.查找描述信息(film.description)中包含robot的电影对应的分类名称(category.name)以及电影数目(count(film.film_id))，而且还需要该分类包含电影总数量(count(film_category.category_id))&gt;=5部</a></p>
<p><a href="https://www.nowcoder.com/practice/a158fa6e79274ac497832697b4b83658?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">29.使用join查询方式找出没有分类的电影id以及名称</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> f.film_id,f.title
<span style="color:#000;font-weight:bold">from</span> film <span style="color:#000;font-weight:bold">as</span> f
<span style="color:#000;font-weight:bold">left</span> <span style="color:#000;font-weight:bold">join</span> film_category <span style="color:#000;font-weight:bold">as</span> fc
<span style="color:#000;font-weight:bold">on</span> f.film_id<span style="color:#000;font-weight:bold">=</span>fc.film_id
<span style="color:#000;font-weight:bold">where</span> fc.category_id <span style="color:#000;font-weight:bold">is</span> <span style="color:#000;font-weight:bold">null</span>
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/2f2e556d335d469f96b91b212c4c203e?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">30.使用子查询的方式找出属于Action分类的所有电影对应的title,description吗</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> title,description
<span style="color:#000;font-weight:bold">from</span> film 
<span style="color:#000;font-weight:bold">where</span> film_id <span style="color:#000;font-weight:bold">in</span>(
    <span style="color:#000;font-weight:bold">select</span> film_id
    <span style="color:#000;font-weight:bold">from</span> film_category
    <span style="color:#000;font-weight:bold">where</span> category_id <span style="color:#000;font-weight:bold">in</span>(
        <span style="color:#000;font-weight:bold">select</span> category_id
        <span style="color:#000;font-weight:bold">from</span> category
        <span style="color:#000;font-weight:bold">where</span> name <span style="color:#000;font-weight:bold">like</span> <span style="color:#d14">&#39;</span><span style="color:#d14">action</span><span style="color:#d14">&#39;</span>
    )
)
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/6744b90bbdde40209f8ecaac0b0516fe?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">32.将employees表的所有员工的last_name和first_name拼接起来作为Name，中间以一个空格区分</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> last_name<span style="color:#000;font-weight:bold">|</span><span style="color:#000;font-weight:bold">|</span><span style="color:#d14">&#34;</span><span style="color:#d14"> </span><span style="color:#d14">&#34;</span><span style="color:#000;font-weight:bold">|</span><span style="color:#000;font-weight:bold">|</span>first_name <span style="color:#000;font-weight:bold">as</span> Name
<span style="color:#000;font-weight:bold">from</span> employees
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/ac233de508ef4849b0eeb4f38dcf09cf?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">33.创建一个actor表，包含如下列信息(注：sqlite获取系统默认时间是datetime(&lsquo;now&rsquo;,&lsquo;localtime&rsquo;))</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">create</span> <span style="color:#000;font-weight:bold">table</span> <span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">not</span> <span style="color:#000;font-weight:bold">exists</span> actor(
    actor_id <span style="color:#0086b3">smallint</span>(<span style="color:#099">5</span>) <span style="color:#000;font-weight:bold">not</span> <span style="color:#000;font-weight:bold">null</span>,
    first_name <span style="color:#0086b3">varchar</span>(<span style="color:#099">45</span>) <span style="color:#000;font-weight:bold">not</span> <span style="color:#000;font-weight:bold">null</span>,
    last_name <span style="color:#0086b3">varchar</span>(<span style="color:#099">45</span>) <span style="color:#000;font-weight:bold">not</span> <span style="color:#000;font-weight:bold">null</span>,
    last_update <span style="color:#000;font-weight:bold">timestamp</span> <span style="color:#000;font-weight:bold">not</span> <span style="color:#000;font-weight:bold">null</span> <span style="color:#000;font-weight:bold">default</span> (datetime(<span style="color:#d14">&#39;</span><span style="color:#d14">now</span><span style="color:#d14">&#39;</span>, <span style="color:#d14">&#39;</span><span style="color:#d14">localtime</span><span style="color:#d14">&#39;</span>)),
    <span style="color:#000;font-weight:bold">primary</span> <span style="color:#000;font-weight:bold">key</span>(actor_id)
)
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/51c12cea6a97468da149c04b7ecf362e?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">34.对于表actor批量插入如下数据(不能有2条insert语句哦!)</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">insert</span> <span style="color:#000;font-weight:bold">into</span> actor <span style="color:#000;font-weight:bold">values</span>
(<span style="color:#099">1</span>,<span style="color:#d14">&#39;</span><span style="color:#d14">PENELOPE</span><span style="color:#d14">&#39;</span>,<span style="color:#d14">&#39;</span><span style="color:#d14">GUINESS</span><span style="color:#d14">&#39;</span>,<span style="color:#d14">&#39;</span><span style="color:#d14">2006-02-15 12:34:33</span><span style="color:#d14">&#39;</span>),
(<span style="color:#099">2</span>,<span style="color:#d14">&#39;</span><span style="color:#d14">NICK</span><span style="color:#d14">&#39;</span>,<span style="color:#d14">&#39;</span><span style="color:#d14">WAHLBERG</span><span style="color:#d14">&#39;</span>,<span style="color:#d14">&#39;</span><span style="color:#d14">2006-02-15 12:34:33</span><span style="color:#d14">&#39;</span>)
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/153c8a8e7805400ba8e384e03acc6b3e?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">35.对于表actor批量插入如下数据,如果数据已经存在，请忽略(不支持使用replace操作)</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">insert</span> <span style="color:#000;font-weight:bold">or</span> <span style="color:#000;font-weight:bold">ignore</span> <span style="color:#000;font-weight:bold">into</span> actor <span style="color:#000;font-weight:bold">values</span>
(<span style="color:#099">3</span>,<span style="color:#d14">&#39;</span><span style="color:#d14">ED</span><span style="color:#d14">&#39;</span>,<span style="color:#d14">&#39;</span><span style="color:#d14">CHASE</span><span style="color:#d14">&#39;</span>,<span style="color:#d14">&#39;</span><span style="color:#d14">2006-02-15 12:34:33</span><span style="color:#d14">&#39;</span>)
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/881385f388cf4fe98b2ed9f8897846df?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">36.请你创建一个actor_name表，并且将actor表中的所有first_name以及last_name导入该表.</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">create</span> <span style="color:#000;font-weight:bold">table</span> actor_name <span style="color:#000;font-weight:bold">as</span>
<span style="color:#000;font-weight:bold">select</span> first_name,last_name <span style="color:#000;font-weight:bold">from</span> actor
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/e1824daa0c49404aa602cf0cb34bdd75?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">37.针对如下表actor结构创建索引</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">create</span> <span style="color:#000;font-weight:bold">unique</span> <span style="color:#000;font-weight:bold">index</span> uniq_idx_firstname <span style="color:#000;font-weight:bold">on</span> actor(first_name);
<span style="color:#000;font-weight:bold">create</span> <span style="color:#000;font-weight:bold">index</span> idx_lastname <span style="color:#000;font-weight:bold">on</span> actor(last_name);
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/b9db784b5e3d488cbd30bd78fdb2a862?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">38.针对actor表创建视图actor_name_view，只包含first_name以及last_name两列，并对这两列重新命名，first_name为first_name_v，last_name修改为last_name_v</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">create</span> <span style="color:#000;font-weight:bold">view</span> actor_name_view
<span style="color:#000;font-weight:bold">as</span> <span style="color:#000;font-weight:bold">select</span> first_name <span style="color:#000;font-weight:bold">as</span> first_name_v,
last_name <span style="color:#000;font-weight:bold">as</span> last_name_v
<span style="color:#000;font-weight:bold">from</span> actor
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/f9fa9dc1a1fc4130b08e26c22c7a1e5f?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">39.针对salaries表emp_no字段创建索引idx_emp_no，查询emp_no为10005, 使用强制索引。</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">SELECT</span> <span style="color:#000;font-weight:bold">*</span> <span style="color:#000;font-weight:bold">FROM</span> salaries INDEXED <span style="color:#000;font-weight:bold">BY</span> idx_emp_no <span style="color:#000;font-weight:bold">WHERE</span> emp_no <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">10005</span>
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/119f04716d284cb7a19fba65dd876b03?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">40.现在在last_update后面新增加一列名字为create_date, 类型为datetime, NOT NULL，默认值为'0000-00-00 00:00:00&rsquo;</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">alter</span> <span style="color:#000;font-weight:bold">table</span> actor 
<span style="color:#000;font-weight:bold">add</span> <span style="color:#000;font-weight:bold">`</span>create_date<span style="color:#000;font-weight:bold">`</span> datetime <span style="color:#000;font-weight:bold">not</span> <span style="color:#000;font-weight:bold">null</span> <span style="color:#000;font-weight:bold">default</span> <span style="color:#d14">&#39;</span><span style="color:#d14">0000-00-00 00:00:00</span><span style="color:#d14">&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/7e920bb2e1e74c4e83750f5c16033e2e?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">41.构造一个触发器audit_log，在向employees_test表中插入一条数据的时候，触发插入相关的数据到audit中。</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">create</span> <span style="color:#000;font-weight:bold">trigger</span> audit_log
<span style="color:#000;font-weight:bold">after</span> <span style="color:#000;font-weight:bold">insert</span>
<span style="color:#000;font-weight:bold">on</span> employees_test
<span style="color:#000;font-weight:bold">begin</span>
<span style="color:#000;font-weight:bold">insert</span> <span style="color:#000;font-weight:bold">into</span> audit <span style="color:#000;font-weight:bold">values</span> (<span style="color:#000;font-weight:bold">NEW</span>.ID,<span style="color:#000;font-weight:bold">NEW</span>.NAME);
<span style="color:#000;font-weight:bold">end</span>;
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/3d92551a6f6d4f1ebde272d20872cf05?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">42.删除emp_no重复的记录，只保留最小的id对应的记录。</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">delete</span> <span style="color:#000;font-weight:bold">from</span> titles_test
<span style="color:#000;font-weight:bold">where</span> id <span style="color:#000;font-weight:bold">not</span> <span style="color:#000;font-weight:bold">in</span> (
    <span style="color:#000;font-weight:bold">select</span> <span style="color:#000;font-weight:bold">min</span>(id)
    <span style="color:#000;font-weight:bold">from</span> titles_test
    <span style="color:#000;font-weight:bold">group</span> <span style="color:#000;font-weight:bold">by</span> emp_no
)
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/859f28f43496404886a77600ea68ef59?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">43.将所有to_date为9999-01-01的全部更新为NULL,且 from_date更新为2001-01-01</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">update</span> titles_test
<span style="color:#000;font-weight:bold">set</span> 
to_date<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">NULL</span>,
from_date<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;</span><span style="color:#d14">2001-01-01</span><span style="color:#d14">&#34;</span>
<span style="color:#000;font-weight:bold">where</span> to_date<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;</span><span style="color:#d14">9999-01-01</span><span style="color:#d14">&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/2bec4d94f525458ca3d0ebf3bc8cd240?tpId=82&amp;&amp;tqId=29812&amp;rp=1&amp;ru=/ta/sql&amp;qru=/ta/sql/question-ranking">44.将id=5以及emp_no=10001的行数据替换成id=5以及emp_no=10005,其他数据保持不变，使用replace实现</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">update</span> titles_test <span style="color:#000;font-weight:bold">set</span> emp_no<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">replace</span>(emp_no,<span style="color:#d14">&#34;</span><span style="color:#d14">10001</span><span style="color:#d14">&#34;</span>,<span style="color:#d14">&#34;</span><span style="color:#d14">10005</span><span style="color:#d14">&#34;</span>) <span style="color:#000;font-weight:bold">where</span> id<span style="color:#000;font-weight:bold">=</span><span style="color:#099">5</span>
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/5277d7f92aa746ab8aa42886e5d570d4?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">45.将titles_test表名修改为titles_2017</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">alter</span> <span style="color:#000;font-weight:bold">table</span> titles_test <span style="color:#000;font-weight:bold">rename</span> <span style="color:#000;font-weight:bold">to</span> titles_2017
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/aeaa116185f24f209ca4fa40e226de48?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">46.在audit表上创建外键约束，其emp_no对应employees_test表的主键id</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">drop</span> <span style="color:#000;font-weight:bold">table</span> audit;
<span style="color:#000;font-weight:bold">create</span> <span style="color:#000;font-weight:bold">table</span> audit(
    EMP_no <span style="color:#0086b3">int</span> <span style="color:#000;font-weight:bold">not</span> <span style="color:#000;font-weight:bold">null</span>,
    create_date datetime <span style="color:#000;font-weight:bold">not</span> <span style="color:#000;font-weight:bold">null</span>,
    <span style="color:#000;font-weight:bold">foreign</span> <span style="color:#000;font-weight:bold">key</span>(EMP_no) <span style="color:#000;font-weight:bold">references</span> employees_test(ID)
)
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/d3b058dcc94147e09352eb76f93b3274?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">47.请你写出更新语句，将所有获取奖金的员工当前的(salaries.to_date='9999-01-01&rsquo;)薪水增加10%。(emp_bonus里面的emp_no都是当前获奖的所有员工)</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">update</span> salaries
<span style="color:#000;font-weight:bold">set</span> salary <span style="color:#000;font-weight:bold">=</span> salary <span style="color:#000;font-weight:bold">*</span> <span style="color:#099">1</span>.<span style="color:#099">1</span> 
<span style="color:#000;font-weight:bold">where</span> salaries.to_date<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;</span><span style="color:#d14">9999-01-01</span><span style="color:#d14">&#39;</span>
<span style="color:#000;font-weight:bold">and</span> emp_no <span style="color:#000;font-weight:bold">in</span> (<span style="color:#000;font-weight:bold">select</span> emp_no <span style="color:#000;font-weight:bold">from</span> emp_bonus)
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/355036f7f0c8429a85281f7ac05b457a?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">48.针对库中的所有表生成select count(*)对应的SQL语句，如数据库里有以下表，(注:在 SQLite 中用 “||” 符号连接字符串，无法使用concat函数)</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> <span style="color:#d14">&#39;</span><span style="color:#d14">select count(*) from</span><span style="color:#d14">&#39;</span> <span style="color:#000;font-weight:bold">|</span><span style="color:#000;font-weight:bold">|</span> name <span style="color:#000;font-weight:bold">|</span><span style="color:#000;font-weight:bold">|</span> <span style="color:#d14">&#39;</span><span style="color:#d14">;</span><span style="color:#d14">&#39;</span> <span style="color:#000;font-weight:bold">as</span> cnts
<span style="color:#000;font-weight:bold">from</span> sqlite_master
<span style="color:#000;font-weight:bold">where</span> <span style="color:#000;font-weight:bold">type</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;</span><span style="color:#d14">table</span><span style="color:#d14">&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.nowcoder.com/practice/810bf4ee3ac64949b08983aa66ec7bee?tpId=82&amp;tags=&amp;title=&amp;diffculty=0&amp;judgeStatus=0&amp;rp=1">49.将employees表中的所有员工的last_name和first_name通过(')连接起来。(不支持concat，请用||实现)</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#000;font-weight:bold">select</span> last_name<span style="color:#000;font-weight:bold">|</span><span style="color:#000;font-weight:bold">|</span><span style="color:#d14">&#34;</span><span style="color:#d14">&#39;</span><span style="color:#d14">&#34;</span><span style="color:#000;font-weight:bold">|</span><span style="color:#000;font-weight:bold">|</span>first_name <span style="color:#000;font-weight:bold">as</span> name
<span style="color:#000;font-weight:bold">from</span> employees
</code></pre></td></tr></table>
</div>
</div>
        </div>

        


        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/post/spider/Aiohttp&#43;PyMongo%E5%BC%82%E6%AD%A5%E6%A1%88%E4%BE%8B%E5%AE%9E%E6%88%98/">Aiohttp&#43;PyMongo异步案例实战</a></li>
        
        <li><a href="/post/spider/PyMongo&#43;PyQuery%E6%A1%88%E4%BE%8B%E5%AE%9E%E6%88%98/">PyMongo&#43;PyQuery案例实战</a></li>
        
        <li><a href="/post/sql/SQL%E5%A4%8D%E4%B9%A0/">SQL复习</a></li>
        
        <li><a href="/post/app/%E4%BD%BF%E7%94%A8Airtest%E7%88%AC%E5%8F%96%E6%9F%90%E5%92%96%E5%95%A1app%E6%95%B0%E6%8D%AEv1/">使用Airtest爬取某咖啡app数据</a></li>
        
        <li><a href="/post/app/%E4%BD%BF%E7%94%A8Airtest%E7%88%AC%E5%8F%96%E6%9F%90%E5%92%96%E5%95%A1app%E6%95%B0%E6%8D%AEv2/">使用Airtest爬取某咖啡app数据v1</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            没有标签
            
        </div>
    </article>
    
    

    
    
    <div class="post bg-white">
      <script src="https://utteranc.es/client.js"
            repo= "https://github.com/hank-leo/hank-leo.github.io"
            issue-term="title"
            theme="github-light"
            crossorigin="anonymous"
            async>
      </script>
    </div>
    
</div>

                    <footer id="footer">
    <div>
        &copy; 2020 <a href="https://hank-leo.github.io">Hank&#39;s Blog By Hank</a>
        
    </div>
    <br />
    
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




    <script src='/js/douban.js'></script>

                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://hank-leo.github.io/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://hank-leo.github.io">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://hank-leo.github.io/post/sql/LeetCode-SQL%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/" title="LeetCode SQL刷题记录">LeetCode SQL刷题记录</a>
    </li>
    
    <li>
        <a href="https://hank-leo.github.io/post/spider/%E7%88%AC%E5%8F%96%E6%9F%90%E8%91%97%E5%90%8D%E5%BF%AB%E9%A4%90%E5%B7%A8%E5%A4%B4%E9%97%A8%E5%BA%97%E6%95%B0%E6%8D%AE%E5%AE%9E%E6%88%98/" title="爬取某著名快餐巨头门店数据实战">爬取某著名快餐巨头门店数据实战</a>
    </li>
    
    <li>
        <a href="https://hank-leo.github.io/post/spider/Aiohttp&#43;PyMongo%E5%BC%82%E6%AD%A5%E6%A1%88%E4%BE%8B%E5%AE%9E%E6%88%98/" title="Aiohttp&#43;PyMongo异步案例实战">Aiohttp&#43;PyMongo异步案例实战</a>
    </li>
    
    <li>
        <a href="https://hank-leo.github.io/post/spider/PyMongo&#43;PyQuery%E6%A1%88%E4%BE%8B%E5%AE%9E%E6%88%98/" title="PyMongo&#43;PyQuery案例实战">PyMongo&#43;PyQuery案例实战</a>
    </li>
    
    <li>
        <a href="https://hank-leo.github.io/post/sql/SQL%E5%A4%8D%E4%B9%A0/" title="SQL复习">SQL复习</a>
    </li>
    
    <li>
        <a href="https://hank-leo.github.io/post/app/%E4%BD%BF%E7%94%A8Airtest%E7%88%AC%E5%8F%96%E6%9F%90%E5%92%96%E5%95%A1app%E6%95%B0%E6%8D%AEv1/" title="使用Airtest爬取某咖啡app数据">使用Airtest爬取某咖啡app数据</a>
    </li>
    
    <li>
        <a href="https://hank-leo.github.io/post/app/%E4%BD%BF%E7%94%A8Airtest%E7%88%AC%E5%8F%96%E6%9F%90%E5%92%96%E5%95%A1app%E6%95%B0%E6%8D%AEv2/" title="使用Airtest爬取某咖啡app数据v1">使用Airtest爬取某咖啡app数据v1</a>
    </li>
    
    <li>
        <a href="https://hank-leo.github.io/post/blog/%E4%BD%BF%E7%94%A8Github-Actions%E6%90%AD%E5%BB%BAhugo/" title="使用Github Actions搭建hugo">使用Github Actions搭建hugo</a>
    </li>
    
    <li>
        <a href="https://hank-leo.github.io/post/python/%E4%BD%BF%E7%94%A8%E5%BC%82%E6%AD%A5%E5%87%BD%E6%95%B0%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E5%90%8D/" title="使用异步函数获取文件名">使用异步函数获取文件名</a>
    </li>
    
    <li>
        <a href="https://hank-leo.github.io/post/spider/pyqt/%E5%88%A9%E7%94%A8PyQt5%E4%BA%A4%E4%BA%92%E5%AF%BC%E5%87%BA%E6%95%B0%E6%8D%AE/" title="利用PyQt5交互导出数据">利用PyQt5交互导出数据</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href="/categories">分类</a></h3>
<ul class="widget-list">
    
    <li><a href="https://hank-leo.github.io/categories/Python%E5%AD%A6%E4%B9%A0/">Python学习 (6)</a></li>
    
    <li><a href="https://hank-leo.github.io/categories/Python%E5%AE%9E%E6%88%98/">Python实战 (2)</a></li>
    
    <li><a href="https://hank-leo.github.io/categories/Scrapy%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A0/">Scrapy框架学习 (11)</a></li>
    
    <li><a href="https://hank-leo.github.io/categories/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/">博客搭建 (3)</a></li>
    
    <li><a href="https://hank-leo.github.io/categories/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AD%A6%E4%B9%A0/">数据分析学习 (3)</a></li>
    
    <li><a href="https://hank-leo.github.io/categories/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%98/">数据分析实战 (4)</a></li>
    
    <li><a href="https://hank-leo.github.io/categories/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/">数据分析报告 (1)</a></li>
    
    <li><a href="https://hank-leo.github.io/categories/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/">数据可视化 (1)</a></li>
    
    <li><a href="https://hank-leo.github.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%A6%E4%B9%A0/">数据库学习 (6)</a></li>
    
    <li><a href="https://hank-leo.github.io/categories/%E6%95%B0%E6%8D%AE%E6%80%9D%E7%BB%B4/">数据思维 (1)</a></li>
    
    <li><a href="https://hank-leo.github.io/categories/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A0/">爬虫学习 (4)</a></li>
    
    <li><a href="https://hank-leo.github.io/categories/%E7%88%AC%E8%99%AB%E5%AE%9E%E6%88%98/">爬虫实战 (4)</a></li>
    
    <li><a href="https://hank-leo.github.io/categories/%E7%88%AC%E8%99%AB%E5%AE%9E%E6%88%98%E5%AE%9E%E6%88%98/">爬虫实战实战 (1)</a></li>
    
    <li><a href="https://hank-leo.github.io/categories/%E7%BB%9F%E8%AE%A1%E5%AD%A6/">统计学 (2)</a></li>
    
    <li><a href="https://hank-leo.github.io/categories/%E9%9D%A2%E8%AF%95%E9%A2%98/">面试题 (2)</a></li>
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href="/tags">标签</a></h3>
<div class="tagcloud">
    
    <a href="https://hank-leo.github.io/tags/MongoDB/">MongoDB</a>
    
    <a href="https://hank-leo.github.io/tags/MySQL/">MySQL</a>
    
    <a href="https://hank-leo.github.io/tags/Python%E9%9D%A2%E8%AF%95/">Python面试</a>
    
    <a href="https://hank-leo.github.io/tags/Scrapy/">Scrapy</a>
    
    <a href="https://hank-leo.github.io/tags/aiohttp/">aiohttp</a>
    
    <a href="https://hank-leo.github.io/tags/airtest/">airtest</a>
    
    <a href="https://hank-leo.github.io/tags/app/">app</a>
    
    <a href="https://hank-leo.github.io/tags/dict/">dict</a>
    
    <a href="https://hank-leo.github.io/tags/excel/">excel</a>
    
    <a href="https://hank-leo.github.io/tags/hexo/">hexo</a>
    
    <a href="https://hank-leo.github.io/tags/hugo/">hugo</a>
    
    <a href="https://hank-leo.github.io/tags/list/">list</a>
    
    <a href="https://hank-leo.github.io/tags/numpy/">numpy</a>
    
    <a href="https://hank-leo.github.io/tags/pandas/">pandas</a>
    
    <a href="https://hank-leo.github.io/tags/pyecharts/">pyecharts</a>
    
    <a href="https://hank-leo.github.io/tags/pymongo/">pymongo</a>
    
    <a href="https://hank-leo.github.io/tags/pyqt5/">pyqt5</a>
    
    <a href="https://hank-leo.github.io/tags/re/">re</a>
    
    <a href="https://hank-leo.github.io/tags/regex/">regex</a>
    
    <a href="https://hank-leo.github.io/tags/requests/">requests</a>
    
    <a href="https://hank-leo.github.io/tags/string/">string</a>
    
    <a href="https://hank-leo.github.io/tags/superset/">superset</a>
    
    <a href="https://hank-leo.github.io/tags/xlwings/">xlwings</a>
    
    <a href="https://hank-leo.github.io/tags/xpath/">xpath</a>
    
    <a href="https://hank-leo.github.io/tags/%E5%BC%82%E6%AD%A5/">异步</a>
    
    <a href="https://hank-leo.github.io/tags/%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97/">数据清洗</a>
    
    <a href="https://hank-leo.github.io/tags/%E7%88%AC%E8%99%AB%E9%9D%A2%E8%AF%95/">爬虫面试</a>
    
</div>
    </section>

    
<section class="widget">
    <h3 class="widget-title">友情链接</h3>
    <ul class="widget-list">
        
        <li>
            <a target="_blank" href="http://cnblogs.hankleo.com" title="博客园">博客园</a>
        </li>
        
    </ul>
</section>


    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://hank-leo.github.io/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>